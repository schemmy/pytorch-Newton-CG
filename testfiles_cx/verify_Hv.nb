(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12678,        315]
NotebookOptionsPosition[     12144,        293]
NotebookOutlinePosition[     12499,        309]
CellTagsIndexPosition[     12456,        306]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"A", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1.0", ",", "2"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"3", ",", " ", "4"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"5", ",", " ", "6"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"x", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "1", "}"}], ",", " ", 
    RowBox[{"{", "1", "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"y", " ", "=", " ", "2"}], "\[IndentingNewLine]", 
 RowBox[{"fx", " ", "=", " ", 
  RowBox[{"Mean", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"A", ".", "x"}], "+", "y"}], ")"}], "^", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gx", " ", "=", " ", 
   RowBox[{
    RowBox[{"2", "/", "3"}], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", "x"}], "+", "y"}], "]"}], 
       RowBox[{"A", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gy", " ", "=", " ", 
   RowBox[{
    RowBox[{"2", "/", "3"}], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"First", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ".", "x"}], "+", "y"}], "]"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"gx", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"gx", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", " ", "gy"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "g", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hxx", " ", "=", " ", 
   RowBox[{
    RowBox[{"2", "/", "3"}], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"A", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "}"}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"A", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", " ", ",", " ", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hxy", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "/", "3"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hyy", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", "2", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Hxx", ",", 
       RowBox[{"Transpose", "[", "Hxy", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Hxy", ",", " ", "Hyy"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "H", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"ArrayFlatten", "[", "H", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7b1uk6XZuteO3+aYuYDoXz9PeYHoyJiaEBDNphsQ
CabrO6NB9BJNi1wQvd2ErwBET3n9tAJEcyjO6AbRCrFP1oDohv5D+0A0i+/z
QyD6PnfMRRAtn55+D0QXPLd5DqI3/jnOaA6kPxWmioBo5e9uGmD+igmGIPqc
0Q0LEB10UNUKRO9Q+ukCoh3sHF1BtITEGS8Qrcdk7Q+iC9eq5YBpWSMwzXM+
vwVE7zrwvRtEP+AtmgGiD+yfCqb5QnctBZtv9WAliF60ymIdiP4W9OsCWFxT
+CaI5niqfgtEd5V8vAuiXWXDXoPoDS8tf4Po3Ze4mC2ANACKG6mU
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.715216093041182*^9, {3.715216236261589*^9, 3.715216256909395*^9}, 
   3.715216330152691*^9, {3.715216371844934*^9, 3.715216422946642*^9}, {
   3.715216454617117*^9, 3.7152164774167423`*^9}, {3.715216859961031*^9, 
   3.715216886551795*^9}, {3.715216924450761*^9, 3.715217026920246*^9}, {
   3.715217146730843*^9, 3.715217210717882*^9}, {3.715217458788312*^9, 
   3.715217571480495*^9}, {3.715217732383321*^9, 3.7152177583861637`*^9}, 
   3.715217796773485*^9, 3.715217876352347*^9, {3.7152180325416937`*^9, 
   3.715218042726426*^9}, 3.715218274337495*^9, {3.7152184745646763`*^9, 
   3.715218528696021*^9}, 3.715218629409803*^9, {3.7152187393128643`*^9, 
   3.715218767916992*^9}, {3.7152188050816174`*^9, 3.715218816299165*^9}, {
   3.715218851345516*^9, 3.7152188903463573`*^9}, {3.715218929520911*^9, 
   3.715219080457184*^9}, 3.715219153952249*^9, {3.715219185584786*^9, 
   3.715219291278075*^9}, {3.715219413041296*^9, 3.71521948133002*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.715216093041182*^9, {3.715216236261589*^9, 3.715216256909395*^9}, 
   3.715216330152691*^9, {3.715216371844934*^9, 3.715216422946642*^9}, {
   3.715216454617117*^9, 3.7152164774167423`*^9}, {3.715216859961031*^9, 
   3.715216886551795*^9}, {3.715216924450761*^9, 3.715217026920246*^9}, {
   3.715217146730843*^9, 3.715217210717882*^9}, {3.715217458788312*^9, 
   3.715217571480495*^9}, {3.715217732383321*^9, 3.7152177583861637`*^9}, 
   3.715217796773485*^9, 3.715217876352347*^9, {3.7152180325416937`*^9, 
   3.715218042726426*^9}, 3.715218274337495*^9, {3.7152184745646763`*^9, 
   3.715218528696021*^9}, 3.715218629409803*^9, {3.7152187393128643`*^9, 
   3.715218767916992*^9}, {3.7152188050816174`*^9, 3.715218816299165*^9}, {
   3.715218851345516*^9, 3.7152188903463573`*^9}, {3.715218929520911*^9, 
   3.715219080457184*^9}, 3.715219153952249*^9, {3.715219185584786*^9, 
   3.715219291278075*^9}, {3.715219413041296*^9, 3.7152194813421907`*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.715216093041182*^9, {3.715216236261589*^9, 3.715216256909395*^9}, 
   3.715216330152691*^9, {3.715216371844934*^9, 3.715216422946642*^9}, {
   3.715216454617117*^9, 3.7152164774167423`*^9}, {3.715216859961031*^9, 
   3.715216886551795*^9}, {3.715216924450761*^9, 3.715217026920246*^9}, {
   3.715217146730843*^9, 3.715217210717882*^9}, {3.715217458788312*^9, 
   3.715217571480495*^9}, {3.715217732383321*^9, 3.7152177583861637`*^9}, 
   3.715217796773485*^9, 3.715217876352347*^9, {3.7152180325416937`*^9, 
   3.715218042726426*^9}, 3.715218274337495*^9, {3.7152184745646763`*^9, 
   3.715218528696021*^9}, 3.715218629409803*^9, {3.7152187393128643`*^9, 
   3.715218767916992*^9}, {3.7152188050816174`*^9, 3.715218816299165*^9}, {
   3.715218851345516*^9, 3.7152188903463573`*^9}, {3.715218929520911*^9, 
   3.715219080457184*^9}, 3.715219153952249*^9, {3.715219185584786*^9, 
   3.715219291278075*^9}, {3.715219413041296*^9, 3.715219481351492*^9}}],

Cell[BoxData[
 RowBox[{"{", "91.66666666666667`", "}"}]], "Output",
 CellChangeTimes->{
  3.715216093041182*^9, {3.715216236261589*^9, 3.715216256909395*^9}, 
   3.715216330152691*^9, {3.715216371844934*^9, 3.715216422946642*^9}, {
   3.715216454617117*^9, 3.7152164774167423`*^9}, {3.715216859961031*^9, 
   3.715216886551795*^9}, {3.715216924450761*^9, 3.715217026920246*^9}, {
   3.715217146730843*^9, 3.715217210717882*^9}, {3.715217458788312*^9, 
   3.715217571480495*^9}, {3.715217732383321*^9, 3.7152177583861637`*^9}, 
   3.715217796773485*^9, 3.715217876352347*^9, {3.7152180325416937`*^9, 
   3.715218042726426*^9}, 3.715218274337495*^9, {3.7152184745646763`*^9, 
   3.715218528696021*^9}, 3.715218629409803*^9, {3.7152187393128643`*^9, 
   3.715218767916992*^9}, {3.7152188050816174`*^9, 3.715218816299165*^9}, {
   3.715218851345516*^9, 3.7152188903463573`*^9}, {3.715218929520911*^9, 
   3.715219080457184*^9}, 3.715219153952249*^9, {3.715219185584786*^9, 
   3.715219291278075*^9}, {3.715219413041296*^9, 3.71521948136068*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"64.66666666666666`"},
      {"82.66666666666666`"},
      {"18.`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.715216093041182*^9, {3.715216236261589*^9, 3.715216256909395*^9}, 
   3.715216330152691*^9, {3.715216371844934*^9, 3.715216422946642*^9}, {
   3.715216454617117*^9, 3.7152164774167423`*^9}, {3.715216859961031*^9, 
   3.715216886551795*^9}, {3.715216924450761*^9, 3.715217026920246*^9}, {
   3.715217146730843*^9, 3.715217210717882*^9}, {3.715217458788312*^9, 
   3.715217571480495*^9}, {3.715217732383321*^9, 3.7152177583861637`*^9}, 
   3.715217796773485*^9, 3.715217876352347*^9, {3.7152180325416937`*^9, 
   3.715218042726426*^9}, 3.715218274337495*^9, {3.7152184745646763`*^9, 
   3.715218528696021*^9}, 3.715218629409803*^9, {3.7152187393128643`*^9, 
   3.715218767916992*^9}, {3.7152188050816174`*^9, 3.715218816299165*^9}, {
   3.715218851345516*^9, 3.7152188903463573`*^9}, {3.715218929520911*^9, 
   3.715219080457184*^9}, 3.715219153952249*^9, {3.715219185584786*^9, 
   3.715219291278075*^9}, {3.715219413041296*^9, 3.71521948137007*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"23.333333333333332`", "29.333333333333332`", "6.`"},
     {"29.333333333333332`", "37.33333333333333`", "8"},
     {"6.`", "8", "2"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.715216093041182*^9, {3.715216236261589*^9, 3.715216256909395*^9}, 
   3.715216330152691*^9, {3.715216371844934*^9, 3.715216422946642*^9}, {
   3.715216454617117*^9, 3.7152164774167423`*^9}, {3.715216859961031*^9, 
   3.715216886551795*^9}, {3.715216924450761*^9, 3.715217026920246*^9}, {
   3.715217146730843*^9, 3.715217210717882*^9}, {3.715217458788312*^9, 
   3.715217571480495*^9}, {3.715217732383321*^9, 3.7152177583861637`*^9}, 
   3.715217796773485*^9, 3.715217876352347*^9, {3.7152180325416937`*^9, 
   3.715218042726426*^9}, 3.715218274337495*^9, {3.7152184745646763`*^9, 
   3.715218528696021*^9}, 3.715218629409803*^9, {3.7152187393128643`*^9, 
   3.715218767916992*^9}, {3.7152188050816174`*^9, 3.715218816299165*^9}, {
   3.715218851345516*^9, 3.7152188903463573`*^9}, {3.715218929520911*^9, 
   3.715219080457184*^9}, 3.715219153952249*^9, {3.715219185584786*^9, 
   3.715219291278075*^9}, {3.715219413041296*^9, 3.715219481382537*^9}}]
}, Open  ]]
},
WindowSize->{668, 597},
WindowMargins->{{Automatic, 110}, {Automatic, 49}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3864, 121, 267, "Input"],
Cell[4447, 145, 1206, 22, 28, "Output"],
Cell[5656, 169, 1098, 18, 28, "Output"],
Cell[6757, 189, 1003, 14, 28, "Output"],
Cell[7763, 205, 1041, 15, 28, "Output"],
Cell[8807, 222, 1651, 34, 74, "Output"],
Cell[10461, 258, 1667, 32, 74, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

